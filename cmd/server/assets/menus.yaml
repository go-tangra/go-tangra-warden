# Warden Module Menu Definitions
# This file defines the menu structure for the Warden (Secret Management) module
# Used by admin service for dynamic menu registration

module:
  id: warden
  name: Warden
  description: Secret and Credential Management

menus:
  - id: warden
    parent_id: null
    type: CATALOG
    name: Warden
    path: /warden
    icon: lucide:vault
    order: 420
    authority:
      - platform:admin
      - tenant:manager

  - id: warden-folders
    parent_id: warden
    type: MENU
    name: Secrets
    path: folder
    component: app/warden/folder/index.vue
    icon: lucide:folder-tree
    order: 2
    authority:
      - platform:admin
      - tenant:manager

  - id: warden-permissions
    parent_id: warden
    type: MENU
    name: Permissions
    path: permission
    component: app/warden/permission/index.vue
    icon: lucide:shield
    order: 3
    authority:
      - platform:admin
      - tenant:manager

dashboard_widgets:
  - id: warden.total_secrets
    name: Total Secrets
    description: Active and total secret counts
    icon: lucide:key-round
    widget_type: stat_card
    data_source:
      endpoint: /admin/v1/modules/warden/v1/stats
      method: GET
    data_mapping:
      value_path: activeSecrets
      total_path: totalSecrets
      label: Active Secrets
    default_size:
      width: 3
      height: 1
    tags: [warden, overview]
    authority: [platform:admin, tenant:manager]

  - id: warden.folders_count
    name: Folders
    description: Total secret folders
    icon: lucide:folder-lock
    widget_type: stat_card
    data_source:
      endpoint: /admin/v1/modules/warden/v1/stats
      method: GET
    data_mapping:
      value_path: totalFolders
      label: Folders
    default_size:
      width: 3
      height: 1
    tags: [warden, overview]
    authority: [platform:admin, tenant:manager]

  - id: warden.versions_stat
    name: Secret Versions
    description: Total secret version history entries
    icon: lucide:history
    widget_type: stat_card
    data_source:
      endpoint: /admin/v1/modules/warden/v1/stats
      method: GET
    data_mapping:
      value_path: totalVersions
      label: Total Versions
    default_size:
      width: 3
      height: 1
    tags: [warden, overview]
    authority: [platform:admin, tenant:manager]

permission_groups:
  - name: Warden
    module: warden
    description: Warden Secret Management Permissions
    permissions:
      - name: View Secrets
        code: warden.secret.view
        description: View secret details and list
      - name: Create Secrets
        code: warden.secret.create
        description: Create new secrets
      - name: Update Secrets
        code: warden.secret.update
        description: Update secret values
      - name: Delete Secrets
        code: warden.secret.delete
        description: Delete secrets
      - name: Manage Folders
        code: warden.folder.manage
        description: Create, update, and delete folders
      - name: Manage Permissions
        code: warden.permission.manage
        description: Manage secret sharing permissions

roles:
  - name: Warden Administrator
    code: warden.admin
    description: Full access to Warden module - can manage all secrets and permissions
    is_system: true
    permissions:
      - warden.secret.view
      - warden.secret.create
      - warden.secret.update
      - warden.secret.delete
      - warden.folder.manage
      - warden.permission.manage

  - name: Warden Operator
    code: warden.operator
    description: Can create and manage secrets
    is_system: true
    permissions:
      - warden.secret.view
      - warden.secret.create
      - warden.secret.update
      - warden.folder.manage

  - name: Warden Viewer
    code: warden.viewer
    description: Read-only access to Warden module
    is_system: true
    permissions:
      - warden.secret.view
