# Generated with protoc-gen-openapi
# https://github.com/google/gnostic/tree/master/cmd/protoc-gen-openapi

openapi: 3.0.3
info:
    title: ""
    version: 0.0.1
paths:
    /v1/bitwarden/export:
        post:
            tags:
                - WardenBitwardenTransferService
            description: Export all secrets and folders as Bitwarden-compatible JSON
            operationId: WardenBitwardenTransferService_ExportToBitwarden
            requestBody:
                content:
                    application/json:
                        schema:
                            $ref: '#/components/schemas/ExportToBitwardenRequest'
                required: true
            responses:
                "200":
                    description: OK
                    content:
                        application/json:
                            schema:
                                $ref: '#/components/schemas/ExportToBitwardenResponse'
    /v1/bitwarden/import:
        post:
            tags:
                - WardenBitwardenTransferService
            description: Import secrets and folders from Bitwarden JSON
            operationId: WardenBitwardenTransferService_ImportFromBitwarden
            requestBody:
                content:
                    application/json:
                        schema:
                            $ref: '#/components/schemas/ImportFromBitwardenRequest'
                required: true
            responses:
                "200":
                    description: OK
                    content:
                        application/json:
                            schema:
                                $ref: '#/components/schemas/ImportFromBitwardenResponse'
    /v1/bitwarden/validate:
        post:
            tags:
                - WardenBitwardenTransferService
            description: Validate Bitwarden JSON without importing (dry-run)
            operationId: WardenBitwardenTransferService_ValidateBitwardenImport
            requestBody:
                content:
                    application/json:
                        schema:
                            $ref: '#/components/schemas/ValidateBitwardenImportRequest'
                required: true
            responses:
                "200":
                    description: OK
                    content:
                        application/json:
                            schema:
                                $ref: '#/components/schemas/ValidateBitwardenImportResponse'
    /v1/folders:
        get:
            tags:
                - WardenFolderService
            description: List folders in a parent folder (or root if no parent specified)
            operationId: WardenFolderService_ListFolders
            parameters:
                - name: parentId
                  in: query
                  description: Parent folder ID (null for root-level folders)
                  schema:
                    type: string
                - name: page
                  in: query
                  description: Pagination
                  schema:
                    type: integer
                    format: uint32
                - name: pageSize
                  in: query
                  schema:
                    type: integer
                    format: uint32
                - name: nameFilter
                  in: query
                  description: Search by name
                  schema:
                    type: string
            responses:
                "200":
                    description: OK
                    content:
                        application/json:
                            schema:
                                $ref: '#/components/schemas/ListFoldersResponse'
        post:
            tags:
                - WardenFolderService
            description: Create a new folder
            operationId: WardenFolderService_CreateFolder
            requestBody:
                content:
                    application/json:
                        schema:
                            $ref: '#/components/schemas/CreateFolderRequest'
                required: true
            responses:
                "200":
                    description: OK
                    content:
                        application/json:
                            schema:
                                $ref: '#/components/schemas/CreateFolderResponse'
    /v1/folders/tree:
        get:
            tags:
                - WardenFolderService
            description: Get the folder tree structure
            operationId: WardenFolderService_GetFolderTree
            parameters:
                - name: rootId
                  in: query
                  description: Root folder ID (null for entire tree)
                  schema:
                    type: string
                - name: maxDepth
                  in: query
                  description: Maximum depth to retrieve
                  schema:
                    type: integer
                    format: int32
                - name: includeCounts
                  in: query
                  description: Include secret counts
                  schema:
                    type: boolean
            responses:
                "200":
                    description: OK
                    content:
                        application/json:
                            schema:
                                $ref: '#/components/schemas/GetFolderTreeResponse'
    /v1/folders/{id}:
        get:
            tags:
                - WardenFolderService
            description: Get a folder by ID
            operationId: WardenFolderService_GetFolder
            parameters:
                - name: id
                  in: path
                  required: true
                  schema:
                    type: string
                - name: includeCounts
                  in: query
                  description: Include secret count
                  schema:
                    type: boolean
            responses:
                "200":
                    description: OK
                    content:
                        application/json:
                            schema:
                                $ref: '#/components/schemas/GetFolderResponse'
        put:
            tags:
                - WardenFolderService
            description: Update folder metadata
            operationId: WardenFolderService_UpdateFolder
            parameters:
                - name: id
                  in: path
                  required: true
                  schema:
                    type: string
            requestBody:
                content:
                    application/json:
                        schema:
                            $ref: '#/components/schemas/UpdateFolderRequest'
                required: true
            responses:
                "200":
                    description: OK
                    content:
                        application/json:
                            schema:
                                $ref: '#/components/schemas/UpdateFolderResponse'
        delete:
            tags:
                - WardenFolderService
            description: Delete a folder (must be empty)
            operationId: WardenFolderService_DeleteFolder
            parameters:
                - name: id
                  in: path
                  required: true
                  schema:
                    type: string
                - name: force
                  in: query
                  description: Force delete even if folder contains items
                  schema:
                    type: boolean
            responses:
                "200":
                    description: OK
                    content: {}
    /v1/folders/{id}/move:
        post:
            tags:
                - WardenFolderService
            description: Move a folder to a new parent
            operationId: WardenFolderService_MoveFolder
            parameters:
                - name: id
                  in: path
                  required: true
                  schema:
                    type: string
            requestBody:
                content:
                    application/json:
                        schema:
                            $ref: '#/components/schemas/MoveFolderRequest'
                required: true
            responses:
                "200":
                    description: OK
                    content:
                        application/json:
                            schema:
                                $ref: '#/components/schemas/MoveFolderResponse'
    /v1/health:
        get:
            tags:
                - WardenSystemService
            description: Health check
            operationId: WardenSystemService_Health
            responses:
                "200":
                    description: OK
                    content:
                        application/json:
                            schema:
                                $ref: '#/components/schemas/HealthResponse'
    /v1/info:
        get:
            tags:
                - WardenSystemService
            description: Get service info
            operationId: WardenSystemService_GetInfo
            responses:
                "200":
                    description: OK
                    content:
                        application/json:
                            schema:
                                $ref: '#/components/schemas/GetInfoResponse'
    /v1/permissions:
        get:
            tags:
                - WardenPermissionService
            description: List permissions on a resource
            operationId: WardenPermissionService_ListPermissions
            parameters:
                - name: resourceType
                  in: query
                  description: Resource type (optional - filter by type)
                  schema:
                    enum:
                        - RESOURCE_TYPE_UNSPECIFIED
                        - RESOURCE_TYPE_FOLDER
                        - RESOURCE_TYPE_SECRET
                    type: string
                    format: enum
                - name: resourceId
                  in: query
                  description: Resource ID (optional - list for specific resource)
                  schema:
                    type: string
                - name: subjectType
                  in: query
                  description: Subject type (optional - filter by subject type)
                  schema:
                    enum:
                        - SUBJECT_TYPE_UNSPECIFIED
                        - SUBJECT_TYPE_USER
                        - SUBJECT_TYPE_ROLE
                        - SUBJECT_TYPE_TENANT
                    type: string
                    format: enum
                - name: subjectId
                  in: query
                  description: Subject ID (optional - list for specific subject)
                  schema:
                    type: string
                - name: page
                  in: query
                  description: Pagination
                  schema:
                    type: integer
                    format: uint32
                - name: pageSize
                  in: query
                  schema:
                    type: integer
                    format: uint32
            responses:
                "200":
                    description: OK
                    content:
                        application/json:
                            schema:
                                $ref: '#/components/schemas/ListPermissionsResponse'
        post:
            tags:
                - WardenPermissionService
            description: Grant access to a resource
            operationId: WardenPermissionService_GrantAccess
            requestBody:
                content:
                    application/json:
                        schema:
                            $ref: '#/components/schemas/GrantAccessRequest'
                required: true
            responses:
                "200":
                    description: OK
                    content:
                        application/json:
                            schema:
                                $ref: '#/components/schemas/GrantAccessResponse'
        delete:
            tags:
                - WardenPermissionService
            description: Revoke access from a resource
            operationId: WardenPermissionService_RevokeAccess
            parameters:
                - name: resourceType
                  in: query
                  description: Resource type
                  schema:
                    enum:
                        - RESOURCE_TYPE_UNSPECIFIED
                        - RESOURCE_TYPE_FOLDER
                        - RESOURCE_TYPE_SECRET
                    type: string
                    format: enum
                - name: resourceId
                  in: query
                  description: Resource ID
                  schema:
                    type: string
                - name: relation
                  in: query
                  description: Relation to revoke (optional - if not specified, revokes all)
                  schema:
                    enum:
                        - RELATION_UNSPECIFIED
                        - RELATION_OWNER
                        - RELATION_EDITOR
                        - RELATION_VIEWER
                        - RELATION_SHARER
                    type: string
                    format: enum
                - name: subjectType
                  in: query
                  description: Subject type
                  schema:
                    enum:
                        - SUBJECT_TYPE_UNSPECIFIED
                        - SUBJECT_TYPE_USER
                        - SUBJECT_TYPE_ROLE
                        - SUBJECT_TYPE_TENANT
                    type: string
                    format: enum
                - name: subjectId
                  in: query
                  description: Subject ID
                  schema:
                    type: string
            responses:
                "200":
                    description: OK
                    content: {}
    /v1/permissions/accessible:
        get:
            tags:
                - WardenPermissionService
            description: List resources accessible by a subject
            operationId: WardenPermissionService_ListAccessibleResources
            parameters:
                - name: userId
                  in: query
                  description: User ID
                  schema:
                    type: string
                - name: resourceType
                  in: query
                  description: Resource type to list
                  schema:
                    enum:
                        - RESOURCE_TYPE_UNSPECIFIED
                        - RESOURCE_TYPE_FOLDER
                        - RESOURCE_TYPE_SECRET
                    type: string
                    format: enum
                - name: permission
                  in: query
                  description: Minimum permission level
                  schema:
                    enum:
                        - PERMISSION_UNSPECIFIED
                        - PERMISSION_READ
                        - PERMISSION_WRITE
                        - PERMISSION_DELETE
                        - PERMISSION_SHARE
                    type: string
                    format: enum
                - name: page
                  in: query
                  description: Pagination
                  schema:
                    type: integer
                    format: uint32
                - name: pageSize
                  in: query
                  schema:
                    type: integer
                    format: uint32
            responses:
                "200":
                    description: OK
                    content:
                        application/json:
                            schema:
                                $ref: '#/components/schemas/ListAccessibleResourcesResponse'
    /v1/permissions/check:
        post:
            tags:
                - WardenPermissionService
            description: Check if a subject has access to a resource
            operationId: WardenPermissionService_CheckAccess
            requestBody:
                content:
                    application/json:
                        schema:
                            $ref: '#/components/schemas/CheckAccessRequest'
                required: true
            responses:
                "200":
                    description: OK
                    content:
                        application/json:
                            schema:
                                $ref: '#/components/schemas/CheckAccessResponse'
    /v1/permissions/effective:
        get:
            tags:
                - WardenPermissionService
            description: Get effective permissions for a subject on a resource
            operationId: WardenPermissionService_GetEffectivePermissions
            parameters:
                - name: userId
                  in: query
                  description: User ID
                  schema:
                    type: string
                - name: resourceType
                  in: query
                  description: Resource type
                  schema:
                    enum:
                        - RESOURCE_TYPE_UNSPECIFIED
                        - RESOURCE_TYPE_FOLDER
                        - RESOURCE_TYPE_SECRET
                    type: string
                    format: enum
                - name: resourceId
                  in: query
                  description: Resource ID
                  schema:
                    type: string
            responses:
                "200":
                    description: OK
                    content:
                        application/json:
                            schema:
                                $ref: '#/components/schemas/GetEffectivePermissionsResponse'
    /v1/secrets:
        get:
            tags:
                - WardenSecretService
            description: List secrets in a folder
            operationId: WardenSecretService_ListSecrets
            parameters:
                - name: folderId
                  in: query
                  description: Folder ID (null for root-level)
                  schema:
                    type: string
                - name: page
                  in: query
                  description: Pagination
                  schema:
                    type: integer
                    format: uint32
                - name: pageSize
                  in: query
                  schema:
                    type: integer
                    format: uint32
                - name: status
                  in: query
                  description: Filter by status
                  schema:
                    enum:
                        - SECRET_STATUS_UNSPECIFIED
                        - SECRET_STATUS_ACTIVE
                        - SECRET_STATUS_ARCHIVED
                        - SECRET_STATUS_DELETED
                    type: string
                    format: enum
                - name: nameFilter
                  in: query
                  description: Filter by name
                  schema:
                    type: string
            responses:
                "200":
                    description: OK
                    content:
                        application/json:
                            schema:
                                $ref: '#/components/schemas/ListSecretsResponse'
        post:
            tags:
                - WardenSecretService
            description: Create a new secret
            operationId: WardenSecretService_CreateSecret
            requestBody:
                content:
                    application/json:
                        schema:
                            $ref: '#/components/schemas/CreateSecretRequest'
                required: true
            responses:
                "200":
                    description: OK
                    content:
                        application/json:
                            schema:
                                $ref: '#/components/schemas/CreateSecretResponse'
    /v1/secrets/search:
        get:
            tags:
                - WardenSecretService
            description: Search secrets across folders
            operationId: WardenSecretService_SearchSecrets
            parameters:
                - name: query
                  in: query
                  description: Search query (searches name, username, host_url, description)
                  schema:
                    type: string
                - name: folderId
                  in: query
                  description: Limit search to folder and subfolders (null for all)
                  schema:
                    type: string
                - name: includeSubfolders
                  in: query
                  description: Include subfolders in search
                  schema:
                    type: boolean
                - name: page
                  in: query
                  description: Pagination
                  schema:
                    type: integer
                    format: uint32
                - name: pageSize
                  in: query
                  schema:
                    type: integer
                    format: uint32
                - name: status
                  in: query
                  description: Filter by status
                  schema:
                    enum:
                        - SECRET_STATUS_UNSPECIFIED
                        - SECRET_STATUS_ACTIVE
                        - SECRET_STATUS_ARCHIVED
                        - SECRET_STATUS_DELETED
                    type: string
                    format: enum
            responses:
                "200":
                    description: OK
                    content:
                        application/json:
                            schema:
                                $ref: '#/components/schemas/SearchSecretsResponse'
    /v1/secrets/{id}:
        get:
            tags:
                - WardenSecretService
            description: Get a secret by ID (returns metadata, not password)
            operationId: WardenSecretService_GetSecret
            parameters:
                - name: id
                  in: path
                  required: true
                  schema:
                    type: string
            responses:
                "200":
                    description: OK
                    content:
                        application/json:
                            schema:
                                $ref: '#/components/schemas/GetSecretResponse'
        put:
            tags:
                - WardenSecretService
            description: Update secret metadata
            operationId: WardenSecretService_UpdateSecret
            parameters:
                - name: id
                  in: path
                  required: true
                  schema:
                    type: string
            requestBody:
                content:
                    application/json:
                        schema:
                            $ref: '#/components/schemas/UpdateSecretRequest'
                required: true
            responses:
                "200":
                    description: OK
                    content:
                        application/json:
                            schema:
                                $ref: '#/components/schemas/UpdateSecretResponse'
        delete:
            tags:
                - WardenSecretService
            description: Delete a secret
            operationId: WardenSecretService_DeleteSecret
            parameters:
                - name: id
                  in: path
                  required: true
                  schema:
                    type: string
                - name: permanent
                  in: query
                  description: Permanently delete (skip soft-delete)
                  schema:
                    type: boolean
            responses:
                "200":
                    description: OK
                    content: {}
    /v1/secrets/{id}/move:
        post:
            tags:
                - WardenSecretService
            description: Move secret to a different folder
            operationId: WardenSecretService_MoveSecret
            parameters:
                - name: id
                  in: path
                  required: true
                  schema:
                    type: string
            requestBody:
                content:
                    application/json:
                        schema:
                            $ref: '#/components/schemas/MoveSecretRequest'
                required: true
            responses:
                "200":
                    description: OK
                    content:
                        application/json:
                            schema:
                                $ref: '#/components/schemas/MoveSecretResponse'
    /v1/secrets/{id}/password:
        get:
            tags:
                - WardenSecretService
            description: Retrieve the password for a secret
            operationId: WardenSecretService_GetSecretPassword
            parameters:
                - name: id
                  in: path
                  required: true
                  schema:
                    type: string
                - name: version
                  in: query
                  description: Specific version (null for current)
                  schema:
                    type: integer
                    format: int32
            responses:
                "200":
                    description: OK
                    content:
                        application/json:
                            schema:
                                $ref: '#/components/schemas/GetSecretPasswordResponse'
        put:
            tags:
                - WardenSecretService
            description: Update secret password (creates new version)
            operationId: WardenSecretService_UpdateSecretPassword
            parameters:
                - name: id
                  in: path
                  required: true
                  schema:
                    type: string
            requestBody:
                content:
                    application/json:
                        schema:
                            $ref: '#/components/schemas/UpdateSecretPasswordRequest'
                required: true
            responses:
                "200":
                    description: OK
                    content:
                        application/json:
                            schema:
                                $ref: '#/components/schemas/UpdateSecretPasswordResponse'
    /v1/secrets/{secretId}/versions:
        get:
            tags:
                - WardenSecretService
            description: List all versions of a secret
            operationId: WardenSecretService_ListVersions
            parameters:
                - name: secretId
                  in: path
                  required: true
                  schema:
                    type: string
                - name: page
                  in: query
                  description: Pagination
                  schema:
                    type: integer
                    format: uint32
                - name: pageSize
                  in: query
                  schema:
                    type: integer
                    format: uint32
            responses:
                "200":
                    description: OK
                    content:
                        application/json:
                            schema:
                                $ref: '#/components/schemas/ListVersionsResponse'
    /v1/secrets/{secretId}/versions/{versionNumber}:
        get:
            tags:
                - WardenSecretService
            description: Get a specific version
            operationId: WardenSecretService_GetVersion
            parameters:
                - name: secretId
                  in: path
                  required: true
                  schema:
                    type: string
                - name: versionNumber
                  in: path
                  required: true
                  schema:
                    type: integer
                    format: int32
                - name: includePassword
                  in: query
                  description: Include password in response
                  schema:
                    type: boolean
            responses:
                "200":
                    description: OK
                    content:
                        application/json:
                            schema:
                                $ref: '#/components/schemas/GetVersionResponse'
    /v1/secrets/{secretId}/versions/{versionNumber}/restore:
        post:
            tags:
                - WardenSecretService
            description: Restore a previous version as current
            operationId: WardenSecretService_RestoreVersion
            parameters:
                - name: secretId
                  in: path
                  required: true
                  schema:
                    type: string
                - name: versionNumber
                  in: path
                  required: true
                  schema:
                    type: integer
                    format: int32
                - name: comment
                  in: query
                  description: Comment for the new version created by restore
                  schema:
                    type: string
            responses:
                "200":
                    description: OK
                    content:
                        application/json:
                            schema:
                                $ref: '#/components/schemas/RestoreVersionResponse'
    /v1/vault/check:
        get:
            tags:
                - WardenSystemService
            description: Check Vault connectivity
            operationId: WardenSystemService_CheckVault
            responses:
                "200":
                    description: OK
                    content:
                        application/json:
                            schema:
                                $ref: '#/components/schemas/CheckVaultResponse'
components:
    schemas:
        CheckAccessRequest:
            required:
                - userId
                - resourceType
                - resourceId
                - permission
            type: object
            properties:
                userId:
                    type: string
                    description: User ID to check
                resourceType:
                    enum:
                        - RESOURCE_TYPE_UNSPECIFIED
                        - RESOURCE_TYPE_FOLDER
                        - RESOURCE_TYPE_SECRET
                    type: string
                    description: Resource type
                    format: enum
                resourceId:
                    type: string
                    description: Resource ID
                permission:
                    enum:
                        - PERMISSION_UNSPECIFIED
                        - PERMISSION_READ
                        - PERMISSION_WRITE
                        - PERMISSION_DELETE
                        - PERMISSION_SHARE
                    type: string
                    description: Permission to check
                    format: enum
            description: Request to check access
        CheckAccessResponse:
            type: object
            properties:
                allowed:
                    type: boolean
                reason:
                    type: string
        CheckVaultResponse:
            type: object
            properties:
                connected:
                    type: boolean
                vaultVersion:
                    type: string
                sealed:
                    type: boolean
                message:
                    type: string
        ComponentHealth:
            type: object
            properties:
                status:
                    enum:
                        - HEALTH_STATUS_UNSPECIFIED
                        - HEALTH_STATUS_HEALTHY
                        - HEALTH_STATUS_DEGRADED
                        - HEALTH_STATUS_UNHEALTHY
                    type: string
                    format: enum
                message:
                    type: string
        CreateFolderRequest:
            required:
                - name
            type: object
            properties:
                parentId:
                    type: string
                    description: Parent folder ID (null for root-level folder)
                name:
                    type: string
                    description: Folder name
                description:
                    type: string
                    description: Optional description
            description: Request to create a folder
        CreateFolderResponse:
            type: object
            properties:
                folder:
                    $ref: '#/components/schemas/Folder'
        CreateSecretRequest:
            required:
                - name
                - password
            type: object
            properties:
                folderId:
                    type: string
                    description: Folder ID (null for root-level)
                name:
                    type: string
                    description: Secret name
                username:
                    type: string
                    description: Username associated with the secret
                password:
                    type: string
                    description: Password to store
                hostUrl:
                    type: string
                    description: Host URL
                description:
                    type: string
                    description: Description
                metadata:
                    type: object
                    description: Custom metadata (JSON)
                versionComment:
                    type: string
                    description: Initial version comment
            description: Request to create a secret
        CreateSecretResponse:
            type: object
            properties:
                secret:
                    $ref: '#/components/schemas/Secret'
        ExportToBitwardenRequest:
            type: object
            properties:
                folderId:
                    type: string
                    description: 'Optional: only export secrets from specific folder and subfolders'
                includeSubfolders:
                    type: boolean
                    description: 'Include secrets from subfolders (default: true)'
            description: Export request
        ExportToBitwardenResponse:
            type: object
            properties:
                jsonData:
                    type: string
                    description: JSON string in Bitwarden format
                foldersExported:
                    type: integer
                    description: Statistics
                    format: int32
                itemsExported:
                    type: integer
                    format: int32
                itemsSkipped:
                    type: integer
                    format: int32
                suggestedFilename:
                    type: string
                    description: Filename suggestion
        Folder:
            type: object
            properties:
                id:
                    type: string
                tenantId:
                    type: integer
                    format: uint32
                parentId:
                    type: string
                name:
                    type: string
                path:
                    type: string
                description:
                    type: string
                depth:
                    type: integer
                    format: int32
                secretCount:
                    type: integer
                    format: int32
                subfolderCount:
                    type: integer
                    format: int32
                createTime:
                    type: string
                    format: date-time
                updateTime:
                    type: string
                    format: date-time
                createdBy:
                    type: integer
                    format: uint32
            description: Folder entity
        FolderTreeNode:
            type: object
            properties:
                folder:
                    $ref: '#/components/schemas/Folder'
                children:
                    type: array
                    items:
                        $ref: '#/components/schemas/FolderTreeNode'
            description: Folder tree node
        GetEffectivePermissionsResponse:
            type: object
            properties:
                permissions:
                    type: array
                    items:
                        enum:
                            - PERMISSION_UNSPECIFIED
                            - PERMISSION_READ
                            - PERMISSION_WRITE
                            - PERMISSION_DELETE
                            - PERMISSION_SHARE
                        type: string
                        format: enum
                highestRelation:
                    enum:
                        - RELATION_UNSPECIFIED
                        - RELATION_OWNER
                        - RELATION_EDITOR
                        - RELATION_VIEWER
                        - RELATION_SHARER
                    type: string
                    format: enum
        GetFolderResponse:
            type: object
            properties:
                folder:
                    $ref: '#/components/schemas/Folder'
        GetFolderTreeResponse:
            type: object
            properties:
                roots:
                    type: array
                    items:
                        $ref: '#/components/schemas/FolderTreeNode'
        GetInfoResponse:
            type: object
            properties:
                version:
                    type: string
                buildTime:
                    type: string
                goVersion:
                    type: string
                gitCommit:
                    type: string
        GetSecretPasswordResponse:
            type: object
            properties:
                password:
                    type: string
                version:
                    type: integer
                    format: int32
        GetSecretResponse:
            type: object
            properties:
                secret:
                    $ref: '#/components/schemas/Secret'
        GetVersionResponse:
            type: object
            properties:
                version:
                    $ref: '#/components/schemas/SecretVersion'
                password:
                    type: string
        GrantAccessRequest:
            required:
                - resourceType
                - resourceId
                - relation
                - subjectType
                - subjectId
            type: object
            properties:
                resourceType:
                    enum:
                        - RESOURCE_TYPE_UNSPECIFIED
                        - RESOURCE_TYPE_FOLDER
                        - RESOURCE_TYPE_SECRET
                    type: string
                    description: Resource type
                    format: enum
                resourceId:
                    type: string
                    description: Resource ID
                relation:
                    enum:
                        - RELATION_UNSPECIFIED
                        - RELATION_OWNER
                        - RELATION_EDITOR
                        - RELATION_VIEWER
                        - RELATION_SHARER
                    type: string
                    description: Relation to grant
                    format: enum
                subjectType:
                    enum:
                        - SUBJECT_TYPE_UNSPECIFIED
                        - SUBJECT_TYPE_USER
                        - SUBJECT_TYPE_ROLE
                        - SUBJECT_TYPE_TENANT
                    type: string
                    description: Subject type
                    format: enum
                subjectId:
                    type: string
                    description: Subject ID
                expiresAt:
                    type: string
                    description: Optional expiration time
                    format: date-time
            description: Request to grant access
        GrantAccessResponse:
            type: object
            properties:
                permission:
                    $ref: '#/components/schemas/PermissionTuple'
        HealthResponse:
            type: object
            properties:
                status:
                    enum:
                        - HEALTH_STATUS_UNSPECIFIED
                        - HEALTH_STATUS_HEALTHY
                        - HEALTH_STATUS_DEGRADED
                        - HEALTH_STATUS_UNHEALTHY
                    type: string
                    format: enum
                message:
                    type: string
                components:
                    type: object
                    additionalProperties:
                        $ref: '#/components/schemas/ComponentHealth'
        ImportError:
            type: object
            properties:
                bitwardenId:
                    type: string
                itemName:
                    type: string
                errorType:
                    type: string
                message:
                    type: string
        ImportFromBitwardenRequest:
            required:
                - jsonData
            type: object
            properties:
                jsonData:
                    type: string
                    description: JSON data (Bitwarden export format)
                targetFolderId:
                    type: string
                    description: Target folder to import into (null for root)
                duplicateHandling:
                    enum:
                        - DUPLICATE_HANDLING_UNSPECIFIED
                        - DUPLICATE_HANDLING_SKIP
                        - DUPLICATE_HANDLING_RENAME
                        - DUPLICATE_HANDLING_OVERWRITE
                    type: string
                    description: How to handle duplicate names
                    format: enum
                preserveFolders:
                    type: boolean
                    description: Whether to import folder structure or flatten to target folder
            description: Import request
        ImportFromBitwardenResponse:
            type: object
            properties:
                foldersCreated:
                    type: integer
                    description: Import statistics
                    format: int32
                itemsImported:
                    type: integer
                    format: int32
                itemsSkipped:
                    type: integer
                    format: int32
                itemsFailed:
                    type: integer
                    format: int32
                errors:
                    type: array
                    items:
                        $ref: '#/components/schemas/ImportError'
                    description: Details of skipped/failed items
                folderIdMapping:
                    type: object
                    additionalProperties:
                        type: string
                    description: Mapping of Bitwarden IDs to Warden IDs
                itemIdMapping:
                    type: object
                    additionalProperties:
                        type: string
        ListAccessibleResourcesResponse:
            type: object
            properties:
                resourceIds:
                    type: array
                    items:
                        type: string
                total:
                    type: integer
                    format: uint32
        ListFoldersResponse:
            type: object
            properties:
                folders:
                    type: array
                    items:
                        $ref: '#/components/schemas/Folder'
                total:
                    type: integer
                    format: uint32
        ListPermissionsResponse:
            type: object
            properties:
                permissions:
                    type: array
                    items:
                        $ref: '#/components/schemas/PermissionTuple'
                total:
                    type: integer
                    format: uint32
        ListSecretsResponse:
            type: object
            properties:
                secrets:
                    type: array
                    items:
                        $ref: '#/components/schemas/Secret'
                total:
                    type: integer
                    format: uint32
        ListVersionsResponse:
            type: object
            properties:
                versions:
                    type: array
                    items:
                        $ref: '#/components/schemas/SecretVersion'
                total:
                    type: integer
                    format: uint32
        MoveFolderRequest:
            required:
                - id
            type: object
            properties:
                id:
                    type: string
                newParentId:
                    type: string
                    description: New parent folder ID (null to move to root)
            description: Request to move a folder
        MoveFolderResponse:
            type: object
            properties:
                folder:
                    $ref: '#/components/schemas/Folder'
        MoveSecretRequest:
            required:
                - id
            type: object
            properties:
                id:
                    type: string
                newFolderId:
                    type: string
                    description: New folder ID (null to move to root)
            description: Request to move a secret
        MoveSecretResponse:
            type: object
            properties:
                secret:
                    $ref: '#/components/schemas/Secret'
        PermissionTuple:
            type: object
            properties:
                id:
                    type: integer
                    format: uint32
                tenantId:
                    type: integer
                    format: uint32
                resourceType:
                    enum:
                        - RESOURCE_TYPE_UNSPECIFIED
                        - RESOURCE_TYPE_FOLDER
                        - RESOURCE_TYPE_SECRET
                    type: string
                    format: enum
                resourceId:
                    type: string
                relation:
                    enum:
                        - RELATION_UNSPECIFIED
                        - RELATION_OWNER
                        - RELATION_EDITOR
                        - RELATION_VIEWER
                        - RELATION_SHARER
                    type: string
                    format: enum
                subjectType:
                    enum:
                        - SUBJECT_TYPE_UNSPECIFIED
                        - SUBJECT_TYPE_USER
                        - SUBJECT_TYPE_ROLE
                        - SUBJECT_TYPE_TENANT
                    type: string
                    format: enum
                subjectId:
                    type: string
                grantedBy:
                    type: integer
                    format: uint32
                expiresAt:
                    type: string
                    format: date-time
                createTime:
                    type: string
                    format: date-time
            description: Permission tuple entity
        RestoreVersionResponse:
            type: object
            properties:
                secret:
                    $ref: '#/components/schemas/Secret'
                newVersion:
                    $ref: '#/components/schemas/SecretVersion'
        SearchSecretsResponse:
            type: object
            properties:
                secrets:
                    type: array
                    items:
                        $ref: '#/components/schemas/Secret'
                total:
                    type: integer
                    format: uint32
        Secret:
            type: object
            properties:
                id:
                    type: string
                tenantId:
                    type: integer
                    format: uint32
                folderId:
                    type: string
                folderPath:
                    type: string
                name:
                    type: string
                username:
                    type: string
                hostUrl:
                    type: string
                description:
                    type: string
                currentVersion:
                    type: integer
                    format: int32
                metadata:
                    type: object
                status:
                    enum:
                        - SECRET_STATUS_UNSPECIFIED
                        - SECRET_STATUS_ACTIVE
                        - SECRET_STATUS_ARCHIVED
                        - SECRET_STATUS_DELETED
                    type: string
                    format: enum
                createTime:
                    type: string
                    format: date-time
                updateTime:
                    type: string
                    format: date-time
                createdBy:
                    type: integer
                    format: uint32
                updatedBy:
                    type: integer
                    format: uint32
            description: Secret entity (without password)
        SecretVersion:
            type: object
            properties:
                id:
                    type: integer
                    format: uint32
                secretId:
                    type: string
                versionNumber:
                    type: integer
                    format: int32
                comment:
                    type: string
                checksum:
                    type: string
                createTime:
                    type: string
                    format: date-time
                createdBy:
                    type: integer
                    format: uint32
            description: Secret version
        UpdateFolderRequest:
            required:
                - id
            type: object
            properties:
                id:
                    type: string
                name:
                    type: string
                    description: New name (optional)
                description:
                    type: string
                    description: New description (optional)
            description: Request to update a folder
        UpdateFolderResponse:
            type: object
            properties:
                folder:
                    $ref: '#/components/schemas/Folder'
        UpdateSecretPasswordRequest:
            required:
                - id
                - password
            type: object
            properties:
                id:
                    type: string
                password:
                    type: string
                    description: New password
                comment:
                    type: string
                    description: Version comment
            description: Request to update secret password
        UpdateSecretPasswordResponse:
            type: object
            properties:
                secret:
                    $ref: '#/components/schemas/Secret'
                version:
                    $ref: '#/components/schemas/SecretVersion'
        UpdateSecretRequest:
            required:
                - id
            type: object
            properties:
                id:
                    type: string
                name:
                    type: string
                    description: New name
                username:
                    type: string
                    description: New username
                hostUrl:
                    type: string
                    description: New host URL
                description:
                    type: string
                    description: New description
                metadata:
                    type: object
                    description: New metadata (replaces existing)
                status:
                    enum:
                        - SECRET_STATUS_UNSPECIFIED
                        - SECRET_STATUS_ACTIVE
                        - SECRET_STATUS_ARCHIVED
                        - SECRET_STATUS_DELETED
                    type: string
                    description: New status
                    format: enum
            description: Request to update secret metadata
        UpdateSecretResponse:
            type: object
            properties:
                secret:
                    $ref: '#/components/schemas/Secret'
        ValidateBitwardenImportRequest:
            required:
                - jsonData
            type: object
            properties:
                jsonData:
                    type: string
                targetFolderId:
                    type: string
                preserveFolders:
                    type: boolean
            description: Validation request (dry-run)
        ValidateBitwardenImportResponse:
            type: object
            properties:
                isValid:
                    type: boolean
                foldersFound:
                    type: integer
                    description: Parse statistics
                    format: int32
                loginItemsFound:
                    type: integer
                    format: int32
                otherItemsFound:
                    type: integer
                    format: int32
                warnings:
                    type: array
                    items:
                        type: string
                    description: Potential issues
                errors:
                    type: array
                    items:
                        type: string
                duplicateNames:
                    type: array
                    items:
                        type: string
                    description: Duplicate detection
tags:
    - name: WardenBitwardenTransferService
      description: Bitwarden Transfer Service - handles import/export in Bitwarden JSON format
    - name: WardenFolderService
      description: Folder Service - manages folder hierarchy for secrets organization
    - name: WardenPermissionService
      description: Permission Service - Zanzibar-like authorization for secrets
    - name: WardenSecretService
      description: Secret Service - manages secrets with versioning and Vault integration
    - name: WardenSystemService
      description: System Service - health checks and system info
